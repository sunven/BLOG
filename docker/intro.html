<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.25">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><title>Docker | sunven</title><meta name="description" content="笔记、博客、awesome">
    <link rel="preload" href="/blog/assets/js/runtime~app.f6f85616.js" as="script"><link rel="preload" href="/blog/assets/css/styles.de2f45b5.css" as="style"><link rel="preload" href="/blog/assets/js/2968.8f760309.js" as="script"><link rel="preload" href="/blog/assets/js/app.0747b7df.js" as="script">
    <link rel="stylesheet" href="/blog/assets/css/styles.de2f45b5.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar"><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/blog/" class=""><!----><span class="site-name">sunven</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="develop"><span class="title">develop</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="develop"><span class="title">develop</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/develop/algorithm/index.html" class="nav-link" aria-label="algorithm"><!--[--><!--]--> algorithm <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/docker/index.html" class="nav-link" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/other/index.html" class="nav-link" aria-label="other"><!--[--><!--]--> other <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/packages/npm.html" class="nav-link" aria-label="packages"><!--[--><!--]--> packages <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/pic/index.html" class="nav-link" aria-label="pic"><!--[--><!--]--> pic <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/python/index.html" class="nav-link" aria-label="python"><!--[--><!--]--> python <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/safe/index.html" class="nav-link" aria-label="safe"><!--[--><!--]--> safe <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/sql/index.html" class="nav-link" aria-label="sql"><!--[--><!--]--> sql <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="docker"><span class="title">docker</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="docker"><span class="title">docker</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a aria-current="page" href="/blog/docker/intro.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="intro"><!--[--><!--]--> intro <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="dotnet"><span class="title">dotnet</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="dotnet"><span class="title">dotnet</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/dotnet/abp/index.html" class="nav-link" aria-label="abp"><!--[--><!--]--> abp <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/dotnet/ddd/index.html" class="nav-link" aria-label="ddd"><!--[--><!--]--> ddd <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/dotnet/designpatterns/index.html" class="nav-link" aria-label="designpatterns"><!--[--><!--]--> designpatterns <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/dotnet/microservice/index.html" class="nav-link" aria-label="microservice"><!--[--><!--]--> microservice <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/dotnet/other/index.html" class="nav-link" aria-label="other"><!--[--><!--]--> other <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/dotnet/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="reading"><span class="title">reading</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="reading"><span class="title">reading</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/reading/goodarticle/2019-01.html" class="nav-link" aria-label="goodarticle"><!--[--><!--]--> goodarticle <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/jsdesignpattern/sheet1.html" class="nav-link" aria-label="jsdesignpattern"><!--[--><!--]--> jsdesignpattern <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/jsdpanddp/jsdpanddp-base.html" class="nav-link" aria-label="jsdpanddp"><!--[--><!--]--> jsdpanddp <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/book.html" class="nav-link" aria-label="book"><!--[--><!--]--> book <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/distributed.html" class="nav-link" aria-label="distributed"><!--[--><!--]--> distributed <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/html5css3.html" class="nav-link" aria-label="html5css3"><!--[--><!--]--> html5css3 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/professionaljavascript.html" class="nav-link" aria-label="professionaljavascript"><!--[--><!--]--> professionaljavascript <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="subject"><span class="title">subject</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="subject"><span class="title">subject</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/subject/math/advanced-mathematics-production-based.html" class="nav-link" aria-label="math"><!--[--><!--]--> math <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="tool"><span class="title">tool</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="tool"><span class="title">tool</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/tool/chrome/index.html" class="nav-link" aria-label="chrome"><!--[--><!--]--> chrome <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/git/index.html" class="nav-link" aria-label="git"><!--[--><!--]--> git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/mac/index.html" class="nav-link" aria-label="mac"><!--[--><!--]--> mac <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/other/index.html" class="nav-link" aria-label="other"><!--[--><!--]--> other <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/sublimetext/index.html" class="nav-link" aria-label="sublimetext"><!--[--><!--]--> sublimetext <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/ubuntu/index.html" class="nav-link" aria-label="ubuntu"><!--[--><!--]--> ubuntu <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/vscode/index.html" class="nav-link" aria-label="vscode"><!--[--><!--]--> vscode <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/Aria2.html" class="nav-link" aria-label="Aria2"><!--[--><!--]--> Aria2 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/awesome.html" class="nav-link" aria-label="awesome"><!--[--><!--]--> awesome <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="web"><span class="title">web</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="web"><span class="title">web</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/web/css/index.html" class="nav-link" aria-label="css"><!--[--><!--]--> css <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/es6/index.html" class="nav-link" aria-label="es6"><!--[--><!--]--> es6 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/js/index.html" class="nav-link" aria-label="js"><!--[--><!--]--> js <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/other/index.html" class="nav-link" aria-label="other"><!--[--><!--]--> other <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/react/index.html" class="nav-link" aria-label="react"><!--[--><!--]--> react <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/vue/index.html" class="nav-link" aria-label="vue"><!--[--><!--]--> vue <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/webpack/intro.html" class="nav-link" aria-label="webpack"><!--[--><!--]--> webpack <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/blog/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/sunven/blog" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="develop"><span class="title">develop</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="develop"><span class="title">develop</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/develop/algorithm/index.html" class="nav-link" aria-label="algorithm"><!--[--><!--]--> algorithm <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/docker/index.html" class="nav-link" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/other/index.html" class="nav-link" aria-label="other"><!--[--><!--]--> other <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/packages/npm.html" class="nav-link" aria-label="packages"><!--[--><!--]--> packages <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/pic/index.html" class="nav-link" aria-label="pic"><!--[--><!--]--> pic <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/python/index.html" class="nav-link" aria-label="python"><!--[--><!--]--> python <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/safe/index.html" class="nav-link" aria-label="safe"><!--[--><!--]--> safe <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/sql/index.html" class="nav-link" aria-label="sql"><!--[--><!--]--> sql <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/develop/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="docker"><span class="title">docker</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="docker"><span class="title">docker</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a aria-current="page" href="/blog/docker/intro.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="intro"><!--[--><!--]--> intro <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="dotnet"><span class="title">dotnet</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="dotnet"><span class="title">dotnet</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/dotnet/abp/index.html" class="nav-link" aria-label="abp"><!--[--><!--]--> abp <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/dotnet/ddd/index.html" class="nav-link" aria-label="ddd"><!--[--><!--]--> ddd <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/dotnet/designpatterns/index.html" class="nav-link" aria-label="designpatterns"><!--[--><!--]--> designpatterns <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/dotnet/microservice/index.html" class="nav-link" aria-label="microservice"><!--[--><!--]--> microservice <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/dotnet/other/index.html" class="nav-link" aria-label="other"><!--[--><!--]--> other <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/dotnet/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="reading"><span class="title">reading</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="reading"><span class="title">reading</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/reading/goodarticle/2019-01.html" class="nav-link" aria-label="goodarticle"><!--[--><!--]--> goodarticle <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/jsdesignpattern/sheet1.html" class="nav-link" aria-label="jsdesignpattern"><!--[--><!--]--> jsdesignpattern <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/jsdpanddp/jsdpanddp-base.html" class="nav-link" aria-label="jsdpanddp"><!--[--><!--]--> jsdpanddp <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/book.html" class="nav-link" aria-label="book"><!--[--><!--]--> book <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/distributed.html" class="nav-link" aria-label="distributed"><!--[--><!--]--> distributed <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/html5css3.html" class="nav-link" aria-label="html5css3"><!--[--><!--]--> html5css3 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/reading/professionaljavascript.html" class="nav-link" aria-label="professionaljavascript"><!--[--><!--]--> professionaljavascript <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="subject"><span class="title">subject</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="subject"><span class="title">subject</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/subject/math/advanced-mathematics-production-based.html" class="nav-link" aria-label="math"><!--[--><!--]--> math <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="tool"><span class="title">tool</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="tool"><span class="title">tool</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/tool/chrome/index.html" class="nav-link" aria-label="chrome"><!--[--><!--]--> chrome <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/git/index.html" class="nav-link" aria-label="git"><!--[--><!--]--> git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/mac/index.html" class="nav-link" aria-label="mac"><!--[--><!--]--> mac <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/other/index.html" class="nav-link" aria-label="other"><!--[--><!--]--> other <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/sublimetext/index.html" class="nav-link" aria-label="sublimetext"><!--[--><!--]--> sublimetext <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/ubuntu/index.html" class="nav-link" aria-label="ubuntu"><!--[--><!--]--> ubuntu <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/vscode/index.html" class="nav-link" aria-label="vscode"><!--[--><!--]--> vscode <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/Aria2.html" class="nav-link" aria-label="Aria2"><!--[--><!--]--> Aria2 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/tool/awesome.html" class="nav-link" aria-label="awesome"><!--[--><!--]--> awesome <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="web"><span class="title">web</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="web"><span class="title">web</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/web/css/index.html" class="nav-link" aria-label="css"><!--[--><!--]--> css <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/es6/index.html" class="nav-link" aria-label="es6"><!--[--><!--]--> es6 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/js/index.html" class="nav-link" aria-label="js"><!--[--><!--]--> js <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/other/index.html" class="nav-link" aria-label="other"><!--[--><!--]--> other <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/react/index.html" class="nav-link" aria-label="react"><!--[--><!--]--> react <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/vue/index.html" class="nav-link" aria-label="vue"><!--[--><!--]--> vue <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/webpack/intro.html" class="nav-link" aria-label="webpack"><!--[--><!--]--> webpack <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/web/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/blog/index.html" class="nav-link" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/sunven/blog" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="docker" tabindex="-1"><a class="header-anchor" href="#docker" aria-hidden="true">#</a> Docker</h1><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装" aria-hidden="true">#</a> 安装</h2><h2 id="镜像加速" tabindex="-1"><a class="header-anchor" href="#镜像加速" aria-hidden="true">#</a> 镜像加速</h2><h2 id="常用命令" tabindex="-1"><a class="header-anchor" href="#常用命令" aria-hidden="true">#</a> 常用命令</h2><h3 id="帮助命令" tabindex="-1"><a class="header-anchor" href="#帮助命令" aria-hidden="true">#</a> 帮助命令</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker version     <span class="token comment">#显示docker的版本信息。</span>
docker info        <span class="token comment">#显示docker的系统信息，包括镜像和容器的数量,更详细</span>
docker 命令 --help  <span class="token comment">#帮助命令</span>

<span class="token comment">#例如：方便查看语法格式，可选参数等，十分爽到</span>
docker images --help
docker search --help
docker pull	--help
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="镜像命令" tabindex="-1"><a class="header-anchor" href="#镜像命令" aria-hidden="true">#</a> 镜像命令</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker images <span class="token comment">#查看所有本地主机上的镜像</span>
docker search <span class="token comment">#搜索镜像</span>
docker pull   <span class="token comment">#下载镜像</span>
docker rmi    <span class="token comment">#删除镜像</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_1-docker-images" tabindex="-1"><a class="header-anchor" href="#_1-docker-images" aria-hidden="true">#</a> 1. docker images</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker images
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    d1165f221234   <span class="token number">3</span> months ago   <span class="token number">13</span>.3kB

<span class="token comment">#1.解释</span>
<span class="token comment">#REPOSITORY			# 镜像的仓库源</span>
<span class="token comment">#TAG				    # 镜像的标签(版本)		---lastest 表示最新版本</span>
<span class="token comment">#IMAGE ID			  # 镜像的id</span>
<span class="token comment">#CREATED			  # 镜像的创建时间</span>
<span class="token comment">#SIZE				    # 镜像的大小</span>

<span class="token comment">#2.可选项（常用的2个）</span>
Options:
  -a, --all         Show all images <span class="token punctuation">(</span>default hides intermediate images<span class="token punctuation">)</span> <span class="token comment">#列出所有镜像</span>
  -q, --quiet       Only show numeric IDs <span class="token comment"># 只显示镜像的id</span>
  
<span class="token comment">#3.示例</span>
<span class="token comment"># docker images -a  #列出所有镜像详细信息</span>
<span class="token comment"># docker images -aq #列出所有镜像的id</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_2-docker-search" tabindex="-1"><a class="header-anchor" href="#_2-docker-search" aria-hidden="true">#</a> 2. docker search</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># docker search mysql</span>

<span class="token comment">#1.可选参数filter</span>
Options:
  -f, --filter filter   Filter output based on conditions provided
      --format string   Pretty-print search using a Go template
      --limit int       Max number of search results <span class="token punctuation">(</span>default <span class="token number">25</span><span class="token punctuation">)</span>
      --no-trunc        Don&#39;t truncate output
<span class="token comment"># --filter=STARS=3000   #过滤，搜索出来的镜像收藏STARS数量大于3000的</span>

<span class="token comment">#2.示例：</span>
<span class="token comment"># docker search mysql --filter=STARS=3000</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_3-docker-pull" tabindex="-1"><a class="header-anchor" href="#_3-docker-pull" aria-hidden="true">#</a> 3. docker pull</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 下载镜像 docker pull 镜像名[:tag]</span>
<span class="token comment"># 上方的tag表示的是镜像的版本，如果不加就是默认下载的最新版</span>
<span class="token comment"># docker pull mysql</span>
Using default tag: latest           <span class="token comment">#下载的最新版</span>
latest: Pulling from library/mysql
69692152171a: Pull complete         <span class="token comment">#分层下载： docker image 的核心 联合文件系统</span>
1651b0be3df3: Pull complete 
951da7386bc8: Pull complete 
0f86c95aa242: Pull complete 
37ba2d8bd4fe: Pull complete 
6d278bb05e94: Pull complete 
497efbd93a3e: Pull complete 
f7fddf10c2c2: Pull complete 
16415d159dfb: Pull complete 
0e530ffc6b73: Pull complete 
b0a4a1a77178: Pull complete 
cd90f92aa9ef: Pull complete 
Digest: sha256:d50098d7fcb25b1fcb24e2d3247cae3fc55815d64fec640dc395840f8fa80969 <span class="token comment">#签名，防伪标志</span>
Status: Downloaded newer image <span class="token keyword">for</span> mysql:latest
docker.io/library/mysql:latest <span class="token comment">#真实地址</span>

<span class="token comment">#知道真实地址：</span>
<span class="token comment">#所以docker pull mysql等价于docker pull docker.io/library/mysql:latest</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_4-docker-rmi" tabindex="-1"><a class="header-anchor" href="#_4-docker-rmi" aria-hidden="true">#</a> 4. docker rmi</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1.首先我们查询出docker中的镜像</span>
<span class="token comment"># docker images</span>
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
mysql         <span class="token number">5.7</span>       2c9028880e58   <span class="token number">4</span> weeks ago    447MB
mysql         latest    c0cdc95609f1   <span class="token number">4</span> weeks ago    556MB
hello-world   latest    d1165f221234   <span class="token number">3</span> months ago   <span class="token number">13</span>.3kB

<span class="token comment">#2.删除镜像，可以通过REPOSITORY或者IMAGE ID来删除</span>
docker rmi -f 镜像id <span class="token comment">#删除指定id的镜像</span>
<span class="token comment">#咱们尝试通过mysql5.7的image id来删除它</span>
<span class="token punctuation">[</span>root@iZ2vc28obhvfham8wewhh0Z ~<span class="token punctuation">]</span><span class="token comment"># docker rmi -f 2c9028880e58</span>
Untagged: mysql:5.7
Untagged: mysql@sha256:a682e3c78fc5bd941e9db080b4796c75f69a28a8cad65677c23f7a9f18ba21fa
Deleted: sha256:2c9028880e5814e8923c278d7e2059f9066d56608a21cd3f83a01e3337bacd68
Deleted: sha256:c49c5c776f1bc87cdfff451ef39ce16a1ef45829e10203f4d9a153a6889ec15e
Deleted: sha256:8345316eca77700e62470611446529113579712a787d356e5c8656a41c244aee
Deleted: sha256:8ae51b87111404bd3e3bde4115ea2fe3fd2bb2cf67158460423c361a24df156b
Deleted: sha256:9d5afda6f6dcf8dd59aef5c02099f1d3b3b0c9ae4f2bb7a61627613e8cdfe562

<span class="token comment">#3.了解删除全部镜像的命令</span>
docker rmi -f <span class="token variable"><span class="token variable">$(</span>docker images -aq<span class="token variable">)</span></span> <span class="token comment">#删除全部的镜像</span>
<span class="token comment">#通过docker images -aq查询出来的所有镜像进行删除</span>

<span class="token comment"># docker images -aq | xargs docker rmi</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="_5-docker-commit" tabindex="-1"><a class="header-anchor" href="#_5-docker-commit" aria-hidden="true">#</a> 5. docker commit</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 命令和git原理类似</span>
docker commit -m<span class="token operator">=</span><span class="token string">&quot;描述信息&quot;</span> -a<span class="token operator">=</span><span class="token string">&quot;作者名字&quot;</span> 容器id 目标镜像名:<span class="token punctuation">[</span>版本TAG<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="容器命令" tabindex="-1"><a class="header-anchor" href="#容器命令" aria-hidden="true">#</a> 容器命令</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker run 镜像id     <span class="token comment">#新建容器并启动</span>
docker <span class="token function">ps</span>             <span class="token comment">#列出所有运行的容器 docker container list</span>
docker <span class="token function">rm</span> 容器id      <span class="token comment">#删除指定容器</span>
docker start 容器id	  <span class="token comment">#启动容器</span>
docker restart 容器id <span class="token comment">#重启容器</span>
docker stop 容器id	  <span class="token comment">#停止当前正在运行的容器</span>
docker <span class="token function">kill</span> 容器id	  <span class="token comment">#强制停止当前容器</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_1-新建容器并启动" tabindex="-1"><a class="header-anchor" href="#_1-新建容器并启动" aria-hidden="true">#</a> 1. 新建容器并启动</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker run <span class="token punctuation">[</span>可选参数<span class="token punctuation">]</span> image <span class="token operator">|</span> docker container run <span class="token punctuation">[</span>可选参数<span class="token punctuation">]</span> image 
<span class="token comment">#参数说明</span>
--name<span class="token operator">=</span><span class="token string">&quot;Name&quot;</span>		<span class="token comment">#容器名字，比如：tomcat01 tomcat02 用来区分容器</span>
-d					    <span class="token comment">#后台方式运行</span>
-it 				    <span class="token comment">#使用交互方式运行，进入容器查看内容</span>
-p					    <span class="token comment">#指定容器的端口，-p 8080(宿主机):8080(容器)</span>
  <span class="token comment">#-p，这个是小写p。主要用法有几种：</span>
	<span class="token comment">#1.-p	主机端口：容器端口（常用）</span>
	<span class="token comment">#2.-p	容器端口</span>
	<span class="token comment">#3.容器端口</span>
	<span class="token comment">#4.-p	ip：主机端口：容器端口</span>
-P					<span class="token comment">#大写P，随机指定端口</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>例子：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1.使用命令运行并进入容器，通过的是bash命令</span>
<span class="token comment"># docker run -it centos bin/bash</span>
<span class="token comment"># ls</span>
bin  etc   lib	  lost+found  mnt  proc  run   srv  tmp  var
dev  home  lib64  media       opt  root  sbin  sys  usr
<span class="token comment">#4.退出容器到主机</span>
<span class="token comment"># exit</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-列出容器" tabindex="-1"><a class="header-anchor" href="#_2-列出容器" aria-hidden="true">#</a> 2. 列出容器</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker <span class="token function">ps</span> 命令  		 <span class="token comment">#列出当前正在运行的容器</span>
  -a, --all     	   <span class="token comment">#列出当前正在运行的容器 + 历史运行过的容器</span>
  -n<span class="token operator">=</span>?, --last int   <span class="token comment">#列出最近创建的?个容器 ?为1则只列出最近创建的一个容器,为2则列出2个</span>
  -q, --quiet        <span class="token comment">#只列出容器的编号</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_3-退出容器" tabindex="-1"><a class="header-anchor" href="#_3-退出容器" aria-hidden="true">#</a> 3. 退出容器</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">exit</span> 		    <span class="token comment">#容器直接退出</span>
ctrl +P +Q  <span class="token comment">#容器不停止退出 	---注意：这个很有用的操作</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_4-删除容器" tabindex="-1"><a class="header-anchor" href="#_4-删除容器" aria-hidden="true">#</a> 4. 删除容器</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker <span class="token function">rm</span> 容器id   				        <span class="token comment">#删除指定的容器，不能删除正在运行的容器，如果要强制删除 rm -rf</span>
docker <span class="token function">rm</span> -f <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -aq<span class="token variable">)</span></span>  	 <span class="token comment">#删除所有的容器，又是参数传递方式，搜出来的结果删</span>
docker <span class="token function">ps</span> -a -q<span class="token operator">|</span><span class="token function">xargs</span> docker <span class="token function">rm</span>  <span class="token comment">#删除所有的容器</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_5-后台启动容器" tabindex="-1"><a class="header-anchor" href="#_5-后台启动容器" aria-hidden="true">#</a> 5. 后台启动容器</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1.后台运行centos</span>
<span class="token comment"># docker run -d centos</span>
dfec0e9a77be8a277779477dc0d5d74b2be42e182cd4cd62efa92547f6833b3a
<span class="token comment">#2.查看运行中的容器，发现没有</span>
<span class="token comment"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
<span class="token comment"># 问题docker ps. 发现centos 停止了</span>
<span class="token comment"># 常见的坑，docker容器使用后台运行，就必须要有要一个前台进程，docker发现没有应用，就会自动停止。</span>
<span class="token comment">#Docker容器后台运行，必须有一个前台进程。容器运行的命令如果不是那些一直挂起的命令（比如运行ping，sleep），就是会自动退出的。</span>
<span class="token comment">#（这样想docker发现启动了也提供不了服务，没有东西需要它就自己关闭了，即是快速开，快速关）</span>
<span class="token comment"># 比如nginx，容器启动后，发现自己没有提供服务，就会立刻停止自杀，就是没有程序了</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_6-查看日志" tabindex="-1"><a class="header-anchor" href="#_6-查看日志" aria-hidden="true">#</a> 6. 查看日志</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1.查看</span>
docker logs --help
<span class="token comment">#可选项</span>
Options:
      --details        Show extra details provided to logs 
  -f, --follow         Follow log output
      --since string   Show logs since timestamp <span class="token punctuation">(</span>e.g. <span class="token number">2013</span>-01-02T13:23:37<span class="token punctuation">)</span> or relative <span class="token punctuation">(</span>e.g. 42m <span class="token keyword">for</span> <span class="token number">42</span> minutes<span class="token punctuation">)</span>
      --tail string    Number of lines to show from the end of the logs <span class="token punctuation">(</span>default <span class="token string">&quot;all&quot;</span><span class="token punctuation">)</span>
  -t, --timestamps     Show timestamps
      --until string   Show logs before a timestamp <span class="token punctuation">(</span>e.g. <span class="token number">2013</span>-01-02T13:23:37<span class="token punctuation">)</span> or relative <span class="token punctuation">(</span>e.g. 42m <span class="token keyword">for</span> <span class="token number">42</span> minutes<span class="token punctuation">)</span>
      
<span class="token comment"># docker run -d centos /bin/sh -c &quot;while true;do echo 6666;sleep 1;done&quot; #模拟日志 </span>

<span class="token comment">#2.显示日志</span>
-tf		                         <span class="token comment">#显示日志信息（一直更新）</span>
--tail number                  <span class="token comment">#需要显示日志条数</span>
docker logs -t --tail n 容器id <span class="token comment">#查看n行日志</span>
docker logs -ft 容器id         <span class="token comment">#跟着日志</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_7-容器中进程信息ps" tabindex="-1"><a class="header-anchor" href="#_7-容器中进程信息ps" aria-hidden="true">#</a> 7. 容器中进程信息ps</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker <span class="token function">top</span> 容器id
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="_8-查看镜像的元数据" tabindex="-1"><a class="header-anchor" href="#_8-查看镜像的元数据" aria-hidden="true">#</a> 8. 查看镜像的元数据</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker inspect 容器id
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="_9-进入当前正在运行的容器" tabindex="-1"><a class="header-anchor" href="#_9-进入当前正在运行的容器" aria-hidden="true">#</a> 9. 进入当前正在运行的容器</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#我们通常容器都是使用后台方式运行的，需要进入容器，修改一些配置</span>
<span class="token comment">#====================方式一====================</span>
<span class="token comment">#1.命令</span>
docker <span class="token builtin class-name">exec</span> -it 容器id bashshell

<span class="token comment">#2.测试</span>
<span class="token comment">#进入容器</span>
docker <span class="token builtin class-name">exec</span> -it 0694e2e1032c bin/bash
<span class="token comment">#进入容器之后我们想干嘛干嘛，比如使用ls命令查看东西之类</span>
<span class="token function">ls</span>
bin  etc   lib	  lost+found  mnt  proc  run   srv  tmp  var
dev  home  lib64  media       opt  root  sbin  sys  usr

<span class="token comment">#====================方式二====================</span>
<span class="token comment">#1.命令</span>
docker attach 容器id
<span class="token comment">#2.测试</span>
docker attach 0694e2e1032c
正在执行当前的代码<span class="token punctuation">..</span>.
<span class="token comment">#方式一和方式二的区别</span>
<span class="token comment">#docker exec   #进入当前容器后开启一个新的终端，可以在里面操作。（常用）</span>
<span class="token comment">#docker attach #进入容器正在执行的终端，不会启动新的进程</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_10-从容器内拷贝到主机" tabindex="-1"><a class="header-anchor" href="#_10-从容器内拷贝到主机" aria-hidden="true">#</a> 10 .从容器内拷贝到主机</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1.命令</span>
docker <span class="token function">cp</span> 容器id:容器内路径（文件名）  主机目的路径
<span class="token comment">#2.测试</span>
docker <span class="token function">cp</span> 0694e2e1032c:/hello.java /home 
<span class="token comment">#将容器内部的/hello.java移动到主机的/home目录下，即使容器关闭了，也可以拷贝出来</span>

<span class="token comment">#拷贝是一个手动过程，未来我们使用-v卷的技术，可以实现自动同步</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_11-其他" tabindex="-1"><a class="header-anchor" href="#_11-其他" aria-hidden="true">#</a> 11. 其他</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#elasticsearch非常占内存，我们可以修改配置文件，进行限制内存使用#修改配置文件 -e 环境配置修改</span>
<span class="token comment"># 在我们之前的启动命令中加入：-e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot;，限定内存在64mb-512mb之间</span>
docker run -d --name elasticsearch2 -p <span class="token number">9200</span>:9200 -p <span class="token number">9300</span>:9300 -e <span class="token string">&quot;discovery.type=single-node&quot;</span> -e <span class="token assign-left variable">ES_JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-Xms64m -Xmx512m&quot;</span> elasticsearch:7.6.2
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="容器数据卷" tabindex="-1"><a class="header-anchor" href="#容器数据卷" aria-hidden="true">#</a> 容器数据卷</h2><p><strong>容器的持久化和同步操作！容器间也是可以数据共享的！</strong></p><h3 id="_1-v-挂载" tabindex="-1"><a class="header-anchor" href="#_1-v-挂载" aria-hidden="true">#</a> 1. -v 挂载</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1. 语法：主要是这个-v</span>
docker run -it -v 主机目录:容器内目录  -p 主机端口:容器内端口

<span class="token comment">#2. run一个centos容器，并使用目录挂载</span>
<span class="token comment"># /home/ceshi：主机home目录下的ceshi文件夹  映射：centos容器中的/home</span>
<span class="token comment"># 将容器里边的home目录挂载到linux的home下边的ceshi目录</span>
docker run -it -v /home/ceshi:/home centos /bin/bash

<span class="token comment">#3.  docker inspect 容器id 查看是否挂载成功</span>
<span class="token punctuation">[</span>root@iZ2vc28obhvfham8wewhh0Z /<span class="token punctuation">]</span><span class="token comment"># docker inspect 54db68df3d7f</span>
<span class="token comment">#具体看下图的Mounts部分，以后两个地址的内的数据可以相互同步的</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_2-mysql数据持久化" tabindex="-1"><a class="header-anchor" href="#_2-mysql数据持久化" aria-hidden="true">#</a> 2. mysql数据持久化</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1. 获取mysql镜像</span>
<span class="token punctuation">[</span>root@iZ2vc28obhvfham8wewhh0Z ~<span class="token punctuation">]</span><span class="token comment"># docker pull mysql:5.7</span>

<span class="token comment">#2. 运行容器的时候需要做数据挂载，此处我们挂载了配置文件以及数据目录（有两个哦），同时咱们也配置了mysql的密码</span>
-d 后台运行
-p 端口映射
-v 卷挂载
-e 环境配置
-- name 容器名字
<span class="token punctuation">[</span>root@iZ2vc28obhvfham8wewhh0Z ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span>

<span class="token comment">#3. 启动成功之后，我们可以在本地去连接上服务器的mysql，如下图所示</span>
<span class="token comment">#咱们走的是3310端口，3310端口映射了容器的3306端口，所以说我们本质还是访问到的容器</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_3-具名匿名挂载" tabindex="-1"><a class="header-anchor" href="#_3-具名匿名挂载" aria-hidden="true">#</a> 3. 具名匿名挂载</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1. 匿名挂载</span>
-v 容器内路径<span class="token operator">!</span>，这里我们没有写主机的路径，那么它就会自动的生成一个目录
<span class="token comment">#1-1. 使用命令匿名挂载</span>
docker run -d -P --name nginx01 -v /etc/nginx nginx

<span class="token comment">#1-1. 查看所有volume（卷）的情况  </span>
<span class="token punctuation">[</span>root@iZ2vc28obhvfham8wewhh0Z data<span class="token punctuation">]</span><span class="token comment"># docker volume ls</span>
DRIVER    VOLUME NAME（卷名字，这个一串乱码其实是真实存在的目录）
<span class="token builtin class-name">local</span>     dd3decdb4e2533d16d216ba19d8797c2ad95b4a2a1b6a90f87eb98bbed3b3758
<span class="token comment"># 注：这里发现，这种就是匿名挂载，我们在 -v只写了容器内的路径，没有写容器外的路径！</span>

<span class="token comment">#2. 具名挂载</span>
<span class="token comment">#2-1. 使用命令具名挂载</span>
docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx
<span class="token comment"># 注1:juming-nginx:/etc/nginx，给/etc/nginx命名为juming-nginx，并没有写主机地址哈</span>
<span class="token comment"># 注2:说白了就是 -v 卷名:容器内路径</span>

<span class="token comment">#2-2. 查看一下这个卷</span>
<span class="token punctuation">[</span>root@iZ2vc28obhvfham8wewhh0Z data<span class="token punctuation">]</span><span class="token comment"># docker volume inspect juming-nginx</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;CreatedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2021-06-25T20:18:22+08:00&quot;</span>,
        <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>,
        <span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> null,
        <span class="token comment">#注意看这儿：下方就是我们挂载到主机的具体路径了</span>
        <span class="token string">&quot;Mountpoint&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/volumes/juming-nginx/_data&quot;</span>,
        <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;juming-nginx&quot;</span>,
        <span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> null,
        <span class="token string">&quot;Scope&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p><strong>总结</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 三种挂载： 匿名挂载、具名挂载、指定路径挂载</span>
-v 容器内路径			      <span class="token comment">#匿名挂载</span>
-v 卷名：容器内路径		    <span class="token comment">#具名挂载</span>
-v /宿主机路径：容器内路径 <span class="token comment">#指定路径挂载 docker volume ls 是查看不到的</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>扩展</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 通过 -v 容器内路径： ro rw 改变读写权限</span>
ro <span class="token comment">#readonly 只读</span>
rw <span class="token comment">#readwrite 可读可写</span>
$ docker run -d -P --name nginx05 -v juming:/etc/nginx:ro nginx
$ docker run -d -P --name nginx05 -v juming:/etc/nginx:rw nginx

<span class="token comment"># ro 只要看到ro就说明这个路径只能通过宿主机来操作，容器内部是无法操作！</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_4-数据卷容器" tabindex="-1"><a class="header-anchor" href="#_4-数据卷容器" aria-hidden="true">#</a> 4. 数据卷容器</h3><ul><li>父容器：A去挂载B，那么B就是A的父容器</li><li>数据卷容器：被挂载的容器</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker run -it --name docker02 --volumes-from docker01 centos
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>容器之间的配置信息的传递，数据卷容器的生命周期一直持续到没有容器使用为止。</p><p>但是一旦你持久化到了本地，这个时候，本地的数据是不会删除的！</p><h2 id="dockerfile" tabindex="-1"><a class="header-anchor" href="#dockerfile" aria-hidden="true">#</a> Dockerfile</h2><h3 id="dockerfile指令" tabindex="-1"><a class="header-anchor" href="#dockerfile指令" aria-hidden="true">#</a> Dockerfile指令</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>FROM				 <span class="token comment"># from:基础镜像，一切从这里开始构建</span>
MAINTAINER  <span class="token comment"># maintainer:镜像是谁写的， 姓名+邮箱</span>
RUN					<span class="token comment"># run:镜像构建的时候需要运行的命令</span>
ADD					<span class="token comment"># add:步骤，tomcat镜像，这个tomcat压缩包！添加内容 添加同目录</span>
WORKDIR				<span class="token comment"># workdir:镜像的工作目录</span>
VOLUME				<span class="token comment"># volume:挂载的目录位置</span>
EXPOSE				<span class="token comment"># expose:暴露端口配置</span>
CMD					<span class="token comment"># cmd:指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被替代</span>
ENTRYPOINT			<span class="token comment"># entrypoint:指定这个容器启动的时候要运行的命令，可以追加命令</span>
ONBUILD				<span class="token comment"># onbuild:当构建一个被继承DockerFile这个时候就会运行onbuild的指令，是触发指令</span>
COPY				<span class="token comment"># copy:类似ADD，将我们文件拷贝到镜像中</span>
ENV					<span class="token comment"># env:构建的时候设置环境变量！</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>FROM centos
MAINTAINER tom<span class="token operator">&lt;</span>a@qq.com<span class="token operator">&gt;</span>

ENV MYPATH /usr/local
WORKDIR <span class="token variable">$MYPATH</span>

RUN yum -y <span class="token function">install</span> <span class="token function">vim</span>
RUN yum -y <span class="token function">install</span> net-tools

EXPOSE <span class="token number">80</span>

CMD <span class="token builtin class-name">echo</span> <span class="token variable">$MYPATH</span>
CMD <span class="token builtin class-name">echo</span> <span class="token string">&quot;---end---&quot;</span>
CMD /bin/bash
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker build -f dockerfile-centos -t mycentos:0.1 <span class="token builtin class-name">.</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="cmd与entrypoint" tabindex="-1"><a class="header-anchor" href="#cmd与entrypoint" aria-hidden="true">#</a> CMD与ENTRYPOINT</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>CMD					    <span class="token comment"># 指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被替代。</span>
ENTRYPOINT			<span class="token comment"># 指定这个容器启动的时候要运行的命令，可以追加命令</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="docker网络" tabindex="-1"><a class="header-anchor" href="#docker网络" aria-hidden="true">#</a> Docker网络</h2><h3 id="_1-原理" tabindex="-1"><a class="header-anchor" href="#_1-原理" aria-hidden="true">#</a> 1. 原理</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#我们发现这个容器带来网卡，都是一对对的</span>
<span class="token comment"># veth-pair 就是一对的虚拟设备接口，他们都是成对出现的，一端连着协议，一端彼此相连</span>
<span class="token comment"># 正因为有这个特性 veth-pair 充当一个桥梁，连接各种虚拟网络设备的</span>
<span class="token comment"># OpenStac,Docker容器之间的连接，OVS的连接，都是使用evth-pair技术</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p><em>情况一：路由器可以直接去访问容器</em></p></blockquote><p><img src="https://raw.githubusercontent.com/sunven/PicBed/master/20210704190642.png" alt="img"></p><blockquote><p><em>情况二：容器之间的访问，比如Tomcat01去访问Tomcat02，路由器就是作为一个中间商</em></p></blockquote><p><img src="https://raw.githubusercontent.com/sunven/PicBed/master/20210704190804.png" alt="img"></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#Tomcat01和Tomcat02是共用的一个路由器，docker0</span>
<span class="token comment">#所有的容器不指定网络的情况下，都是docker0路由的，docker会给我们的容器分配一个默认的可用ip</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Docker使用的是Linux的桥接，宿主机是一个Docker容器的网桥 docker0</p><p><img src="https://raw.githubusercontent.com/sunven/PicBed/master/20210704190858.png" alt="img"></p><h3 id="_2-link" tabindex="-1"><a class="header-anchor" href="#_2-link" aria-hidden="true">#</a> 2. --link</h3><p>本质就是在hosts配置中添加映射，现在使用Docker已经不建议使用–-link了！</p><h3 id="_3-自定义网络" tabindex="-1"><a class="header-anchor" href="#_3-自定义网络" aria-hidden="true">#</a> 3. 自定义网络</h3><p><strong>网络模式：</strong></p><ul><li><strong>bridge ：桥接 docker（默认，自己创建也是用bridge模式）</strong></li><li>none ：不配置网络，一般不用</li><li>host ：和宿主机共享网络</li><li>container ：容器网络连通（用得少！局限很大）</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 我们直接启动的命令 --net bridge,而这个就是我们的docker0</span>
<span class="token comment"># bridge就是docker0</span>
<span class="token comment">#&quot;--net bridge&quot;就是默认参数</span>
docker run -d -P --name tomcat01 tomcat
docker run -d -P --name tomcat01 --net bridge tomcat
<span class="token comment">#------------------------------------------------------</span>
<span class="token comment">#------------------------------------------------------</span>

<span class="token comment">#自定义网络：</span>

<span class="token comment">#1. 清理环境，删除之前的容器</span>
docker <span class="token function">rm</span> -f  <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -aq<span class="token variable">)</span></span>

<span class="token comment">#2. 创建一个子网为“192.168.0.0/16”，网关（路由）为“192.168.0.1”，网络名字为“mynet”的网络</span>
docker network create --driver bridge --subnet <span class="token number">192.168</span>.0.0/16 --gateway <span class="token number">192.168</span>.0.1 mynet

<span class="token comment">#3. 查看创建的网络</span>
docker network <span class="token function">ls</span>

<span class="token comment">#4. 创建两个个tomcat使用我们自定义的网络</span>
docker run -d -P --name tomcat-net-01 --net mynet tomcat
docker run -d -P --name tomcat-net-02 --net mynet tomcat

<span class="token comment">#5. 然后查看我们自定义的网络，如下图所示</span>
docker network inspect 56505443b59d

<span class="token comment">#6. 我们再来ping容器</span>
docker <span class="token builtin class-name">exec</span> -it tomcat-net-01 <span class="token function">ping</span> tomcat-net-02
docker <span class="token builtin class-name">exec</span> -it tomcat-net-01 <span class="token function">ping</span> <span class="token number">192.168</span>.0.3
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="_4-网络联通" tabindex="-1"><a class="header-anchor" href="#_4-网络联通" aria-hidden="true">#</a> 4. 网络联通</h3><p><img src="https://raw.githubusercontent.com/sunven/PicBed/master/20210704191318.png" alt="img"></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#语法：docker network connect [OPTIONS] NETWORK CONTAINER</span>
<span class="token comment">#1. 之前删除的tomcat01和tomcat02创建好</span>
docker run -d -P --name tomcat01 tomcat
docker run -d -P --name tomcat02 tomcat

<span class="token comment">#2. 打通tomcat01和mynet</span>
docker network connect mynet tomcat01

<span class="token comment">#3. 查看网络配置，如下图所示：</span>
docker network inspect mynet
<span class="token comment"># 要将tomcat01 连通 tomcat—net-01 ，连通就是将 tomcat01加到 mynet网络</span>
<span class="token comment"># 一个容器两个ip（tomcat01）</span>

<span class="token comment">#4. 现在我们再ping一下</span>
<span class="token punctuation">[</span>root@iZ2vc28obhvfham8wewhh0Z ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat01 ping tomcat-net-02</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_5-测试" tabindex="-1"><a class="header-anchor" href="#_5-测试" aria-hidden="true">#</a> 5.测试</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1. 先移除之前的容器</span>
docker <span class="token function">rm</span> -f <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -aq<span class="token variable">)</span></span>

<span class="token comment">#2. 创建redis的网卡</span>
docker network create redis --subnet <span class="token number">172.38</span>.0.0/16

<span class="token comment">#3. 通过脚本去写配置文件</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">port</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">seq</span> <span class="token number">1</span> <span class="token number">6</span><span class="token variable">)</span></span><span class="token punctuation">;</span><span class="token punctuation">\</span>
<span class="token keyword">do</span> <span class="token punctuation">\</span>
<span class="token function">mkdir</span> -p /mydata/redis/node-<span class="token variable">${port}</span>/conf
<span class="token function">touch</span> /mydata/redis/node-<span class="token variable">${port}</span>/conf/redis.conf
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;&gt;</span> /mydata/redis/node-<span class="token variable">${port}</span>/conf/redis.conf</span>
port 6379
bind 0.0.0.0
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000
cluster-announce-ip 172.38.0.1<span class="token variable">${port}</span>
cluster-announce-port 6379
cluster-announce-bus-port 16379
appendonly yes
EOF</span>
<span class="token keyword">done</span>

<span class="token comment">#4. 通过脚本创建六个redis文件</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">port</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">seq</span> <span class="token number">1</span> <span class="token number">6</span><span class="token variable">)</span></span><span class="token punctuation">;</span><span class="token punctuation">\</span>
docker run -p <span class="token number">637</span><span class="token variable">${port}</span>:6379 -p <span class="token number">1637</span><span class="token variable">${port}</span>:16379 --name redis-<span class="token variable">${port}</span> <span class="token punctuation">\</span>
-v /mydata/redis/node-<span class="token variable">${port}</span>/data:/data <span class="token punctuation">\</span>
-v /mydata/redis/node-<span class="token variable">${port}</span>/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\</span>
-d --net redis --ip <span class="token number">172.38</span>.0.1<span class="token variable">${port}</span> redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf<span class="token punctuation">;</span> <span class="token punctuation">\</span>
<span class="token comment">#5. 然后依次运行</span>
docker <span class="token builtin class-name">exec</span> -it redis-1 /bin/sh 
docker <span class="token builtin class-name">exec</span> -it redis-2 /bin/sh 
docker <span class="token builtin class-name">exec</span> -it redis-3 /bin/sh 
docker <span class="token builtin class-name">exec</span> -it redis-4 /bin/sh 
docker <span class="token builtin class-name">exec</span> -it redis-5 /bin/sh 
docker <span class="token builtin class-name">exec</span> -it redis-6 /bin/sh 

<span class="token comment">#6. 创建集群</span>
redis-cli --cluster create <span class="token number">172.38</span>.0.11:6379 <span class="token number">172.38</span>.0.12:6379 <span class="token number">172.38</span>.0.13:6379 <span class="token number">172.38</span>.0.14:6379 <span class="token number">172.38</span>.0.15:6379 <span class="token number">172.38</span>.0.16:6379  --cluster-replicas <span class="token number">1</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="docker-compose" tabindex="-1"><a class="header-anchor" href="#docker-compose" aria-hidden="true">#</a> Docker Compose</h2><p>定义运行多个容器</p><p>地址：https://docs.docker.com/compose/gettingstarted/</p><p>https://docs.docker.com/compose/wordpress/</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker-compose down         <span class="token comment"># 关闭容器</span>
docker-compose up --build   <span class="token comment"># 重新构建</span>
docker-compose up -d
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="docker-swarm" tabindex="-1"><a class="header-anchor" href="#docker-swarm" aria-hidden="true">#</a> Docker Swarm</h2><p>4台机器，xshell同步操作</p><p><img src="https://docs.docker.com/engine/swarm/images/swarm-diagram.png" alt="img"></p><h3 id="manager-nodes" tabindex="-1"><a class="header-anchor" href="#manager-nodes" aria-hidden="true">#</a> Manager nodes</h3><p>使用<a href="https://raft.github.io/raft.pdf" target="_blank" rel="noopener noreferrer">Raft<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>实现，管理者保持整个群和所有运行在它的服务的一致内部状态</p><ul><li>管理集群状态</li><li>调度</li></ul><p>可故障的管理节点数:(N-1)/2</p><p>3个最多可以有一个故障</p><p>5个最多可以有两个故障</p><p>一个几圈最多简易有7个管理节点</p><p>增加更多的管理者并不意味着可扩展性或更高的性能。一般来说，情况正好相反</p><h3 id="worker-nodes" tabindex="-1"><a class="header-anchor" href="#worker-nodes" aria-hidden="true">#</a> Worker nodes</h3><ul><li>执行容器</li></ul><h3 id="命令" tabindex="-1"><a class="header-anchor" href="#命令" aria-hidden="true">#</a> 命令</h3><p>初始化</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker swarm init --help
 
<span class="token function">ip</span> addr <span class="token comment"># 获取自己的ip（用内网的不要流量）</span>
 
docker swarm init --advertise-addr <span class="token number">172.16</span>.250.97
Swarm initialized: current node <span class="token punctuation">(</span>otdyxbk2ffbogdqq1kigysj1d<span class="token punctuation">)</span> is now a manager.
To <span class="token function">add</span> a worker to this swarm, run the following command:
    docker swarm <span class="token function">join</span> --token SWMTKN-1-3vovnwb5pkkno2i3u2a42yrxc1dk51zxvto5hrm4asgn37syfn-0xkrprkuyyhrx7cidg381pdir <span class="token number">172.16</span>.250.97:2377
To <span class="token function">add</span> a manager to this swarm, run <span class="token string">&#39;docker swarm join-token manager&#39;</span> and follow the instructions.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 获取令牌</span>
docker swarm join-token manager
docker swarm join-token worker

<span class="token comment"># 加入swarm</span>
docker swarm <span class="token function">join</span> --token SWMTKN-1-3vovnwb5pkkno2i3u2a42yrxc1dk51zxvto5hrm4asgn37syfn-0xkrprkuyyhrx7cidg381pdir <span class="token number">172.16</span>.250.97:2377

<span class="token comment"># 离开swarm</span>
docker swarm leave
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>docker run     <span class="token comment"># 容器启动！ 不具有扩缩容器</span>
docker <span class="token function">service</span> <span class="token comment"># 服务！ 具有扩缩容器，滚动更新！</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 查看服务列表</span>
docker <span class="token function">service</span> <span class="token function">ls</span>

<span class="token comment"># 查看服务信息</span>
docker <span class="token function">service</span> <span class="token function">ps</span> servicename

<span class="token comment"># 扩缩容</span>
docker <span class="token function">service</span> update --replicas <span class="token number">3</span> my-nginx
docker <span class="token function">service</span> scale my-nginx<span class="token operator">=</span><span class="token number">5</span>

<span class="token comment"># 移除</span>
docker <span class="token function">service</span> <span class="token function">rm</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="service如何工作" tabindex="-1"><a class="header-anchor" href="#service如何工作" aria-hidden="true">#</a> service如何工作</h3><p><img src="https://docs.docker.com/engine/swarm/images/services-diagram.png" alt="services diagram"></p><h3 id="任务和调度" tabindex="-1"><a class="header-anchor" href="#任务和调度" aria-hidden="true">#</a> 任务和调度</h3><p><img src="https://docs.docker.com/engine/swarm/images/service-lifecycle.png" alt="services flow"></p><h3 id="副本和服务" tabindex="-1"><a class="header-anchor" href="#副本和服务" aria-hidden="true">#</a> 副本和服务</h3><p><img src="https://docs.docker.com/engine/swarm/images/replicated-vs-global.png" alt="global vs replicated services"></p><h2 id="reference" tabindex="-1"><a class="header-anchor" href="#reference" aria-hidden="true">#</a> reference</h2><p><a href="https://blog.csdn.net/GTX_WU/article/details/118370049" target="_blank" rel="noopener noreferrer">狂神Docker学习笔记_Lemonyuki的博客-CSDN博客<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p><a href="https://u19900101.github.io/2021-04-16-Docker%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0_21h2d/" target="_blank" rel="noopener noreferrer">Docker入门学习笔记(21h/2d 4.14-16) (u19900101.github.io)<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/sunven/blog/edit/main/docker/intro.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">2021/7/15 下午12:32:28</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 604164227@qq.com">sunven</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/blog/assets/js/runtime~app.f6f85616.js" defer></script><script src="/blog/assets/js/2968.8f760309.js" defer></script><script src="/blog/assets/js/app.0747b7df.js" defer></script>
  </body>
</html>
